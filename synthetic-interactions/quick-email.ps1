# Quick Email Sender for CartPilot
param([switch]$SendNow = $false)

Write-Host "ğŸ“§ CartPilot Email Reporter" -ForegroundColor Magenta

if ($SendNow) {
    try {
        $outlook = New-Object -ComObject Outlook.Application
        $mail = $outlook.CreateItem(0)
        $mail.To = "davidward8668@gmail.com"
        $mail.Subject = "CartPilot Status Update - $(Get-Date -Format 'dd/MM/yyyy HH:mm')"
        
        $body = @"
<h1 style='color: #667eea;'>ğŸ›’ CartPilot Status Report</h1>
<h2>âœ… Production Status: HEALTHY</h2>
<p><strong>Live URL:</strong> <a href='https://cartpilot-sigma.vercel.app'>https://cartpilot-sigma.vercel.app</a></p>

<h2>ğŸ“Š Recent Achievements</h2>
<ul>
<li>âœ… Test failures reduced: 29 â†’ 16 (45% improvement)</li>
<li>âœ… Notification service enhanced with proper settings management</li>
<li>âœ… Dev environment synchronized with production</li>
<li>âœ… Production fixes committed to git</li>
</ul>

<h2>ğŸ¯ User Metrics</h2>
<p>Dave is currently <strong>#1 Global Rank</strong> with <strong>197 points</strong> and <strong>96 contributions</strong></p>

<h2>ğŸ”§ Issues Identified</h2>
<ul>
<li>ğŸ“± Camera access blocked for barcode scanner and AI store mapper</li>
<li>ğŸ® Gamification needs more tutorial guidance</li>
<li>ğŸ—³ï¸ Need voting system for product location accuracy</li>
<li>ğŸ‘¤ Missing user dietary preferences (allergen management)</li>
</ul>

<h2>ğŸš€ Next Phase</h2>
<p>Ready for Tesco partnership implementation with Â£50M ARR target</p>

<hr>
<p><small>ğŸ¤– Generated by Claude Code Autonomous Development System</small></p>
"@
        
        $mail.HTMLBody = $body
        $mail.Send()
        
        Write-Host "âœ… Email sent successfully!" -ForegroundColor Green
        Write-Host "ğŸ“§ Sent to: davidward8668@gmail.com" -ForegroundColor Cyan
    }
    catch {
        Write-Host "âŒ Error: $($_.Exception.Message)" -ForegroundColor Red
    }
} else {
    Write-Host "Use -SendNow to send email immediately" -ForegroundColor Yellow
}